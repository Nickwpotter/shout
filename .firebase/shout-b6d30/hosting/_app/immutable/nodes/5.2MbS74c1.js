import{s as Ke,n as Re,c as Ee,o as We,a as Ue,b as Xe,r as Ye}from"../chunks/scheduler.Bnq60-53.js";import{S as Ze,i as $e,e as i,c,a as g,d as h,m as l,g as le,q as et,r as Je,s as k,t as ie,f as C,l as J,b as ce,h as t,o as oe,j as _e,u as tt,n as Y,v as Ae,p as lt,w as qe,x as Me}from"../chunks/index.Ds0bHGC8.js";import{e as Ve}from"../chunks/each.D6YF6ztN.js";import{b as at,d as Te,e as Be,q as st,c as He,g as nt,a as rt}from"../chunks/firebase.xiFXEIL6.js";import{w as Qe}from"../chunks/index.Cyf_2U9l.js";import{a as ot}from"../chunks/authStore.DxuuDmKm.js";import{p as it}from"../chunks/stores.BsDo_Qma.js";import{g as ct}from"../chunks/entry.77B6Ku6h.js";function Oe(s,a,e){const r=s.slice();return r[29]=a[e],r}function dt(s){let a,e,r,o,n,f,_,v,H="Merchant:",w,G,N,L,F,Z="Influencer:",D,E,j,I,y,Q="Start Date:",ae,W=s[11].promotionStartDate+"",M,$,x,S,de="QR Code ID:",ee,U,te,d,T,m,A,se="Download QR Code",X,be;return{c(){a=i("div"),e=i("div"),r=i("div"),o=i("img"),f=k(),_=i("p"),v=i("span"),v.textContent=H,w=k(),G=ie(s[1]),N=k(),L=i("p"),F=i("span"),F.textContent=Z,D=k(),E=ie(s[5]),j=k(),I=i("p"),y=i("span"),y.textContent=Q,ae=k(),M=ie(W),$=k(),x=i("p"),S=i("span"),S.textContent=de,ee=k(),U=ie(s[10]),te=k(),d=i("a"),T=ie("Test QR Code Link"),m=k(),A=i("button"),A.textContent=se,this.h()},l(V){a=c(V,"DIV",{class:!0});var P=g(a);e=c(P,"DIV",{class:!0});var p=g(e);r=c(p,"DIV",{class:!0});var ue=g(r);o=c(ue,"IMG",{src:!0,alt:!0,class:!0}),ue.forEach(h),f=C(p),_=c(p,"P",{class:!0});var ne=g(_);v=c(ne,"SPAN",{class:!0,"data-svelte-h":!0}),J(v)!=="svelte-5erjst"&&(v.textContent=H),w=C(ne),G=ce(ne,s[1]),ne.forEach(h),N=C(p),L=c(p,"P",{class:!0});var K=g(L);F=c(K,"SPAN",{class:!0,"data-svelte-h":!0}),J(F)!=="svelte-8hwr1a"&&(F.textContent=Z),D=C(K),E=ce(K,s[5]),K.forEach(h),j=C(p),I=c(p,"P",{class:!0});var fe=g(I);y=c(fe,"SPAN",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-92ix5p"&&(y.textContent=Q),ae=C(fe),M=ce(fe,W),fe.forEach(h),$=C(p),x=c(p,"P",{class:!0});var re=g(x);S=c(re,"SPAN",{class:!0,"data-svelte-h":!0}),J(S)!=="svelte-2oankk"&&(S.textContent=de),ee=C(re),U=ce(re,s[10]),re.forEach(h),te=C(p),d=c(p,"A",{href:!0,target:!0,class:!0});var z=g(d);T=ce(z,"Test QR Code Link"),z.forEach(h),m=C(p),A=c(p,"BUTTON",{class:!0,"data-svelte-h":!0}),J(A)!=="svelte-i8nhyw"&&(A.textContent=se),p.forEach(h),P.forEach(h),this.h()},h(){Ue(o.src,n=s[0])||l(o,"src",n),l(o,"alt","QR Code"),l(o,"class","w-40 h-40"),l(r,"class","bg-white p-2 mb-4 rounded-lg"),l(v,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),l(_,"class","text-white font-bold mb-2"),l(F,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),l(L,"class","text-white font-bold mb-2"),l(y,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),l(I,"class","text-white font-bold mb-2"),l(S,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),l(x,"class","text-white font-bold mb-2"),l(d,"href",s[2]),l(d,"target","_blank"),l(d,"class","btn btn-active btn-link"),l(A,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full mt-4"),l(e,"class","w-full max-w-sm shadow-lg rounded-lg p-6 bg-black flex flex-col items-center"),l(a,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% p-2 rounded-lg")},m(V,P){le(V,a,P),t(a,e),t(e,r),t(r,o),t(e,f),t(e,_),t(_,v),t(_,w),t(_,G),t(e,N),t(e,L),t(L,F),t(L,D),t(L,E),t(e,j),t(e,I),t(I,y),t(I,ae),t(I,M),t(e,$),t(e,x),t(x,S),t(x,ee),t(x,U),t(e,te),t(e,d),t(d,T),t(e,m),t(e,A),X||(be=oe(A,"click",s[17]),X=!0)},p(V,P){P[0]&1&&!Ue(o.src,n=V[0])&&l(o,"src",n),P[0]&2&&_e(G,V[1]),P[0]&32&&_e(E,V[5]),P[0]&2048&&W!==(W=V[11].promotionStartDate+"")&&_e(M,W),P[0]&1024&&_e(U,V[10]),P[0]&4&&l(d,"href",V[2])},d(V){V&&h(a),X=!1,be()}}}function ut(s){let a,e="Create Campaign Code",r,o,n,f,_,v='<span class="text-white">Merchant</span>',H,w,G,N,L,F='<span class="!text-white">Influencer</span>',Z,D,E,j="Pick one",I,y,Q,ae='<span class="text-white">Promotion Start Date</span>',W,M,$,x,S,de='<span class="text-white">Promotion Duration</span>',ee,U,te,d,T,m,A,se,X,be="Days",V,P,p,ue,ne,K,fe="Hours",re,z,ve,xe,Le,Ie,Se,pe=Ve(s[4]),q=[];for(let u=0;u<pe.length;u+=1)q[u]=je(Oe(s,pe,u));let O=s[12]&&ze(),B=s[13]&&Ge(s);return Le=tt(s[24][0]),{c(){a=i("h1"),a.textContent=e,r=k(),o=i("div"),n=i("div"),f=i("div"),_=i("label"),_.innerHTML=v,H=k(),w=i("input"),G=k(),N=i("label"),L=i("div"),L.innerHTML=F,Z=k(),D=i("select"),E=i("option"),E.textContent=j;for(let u=0;u<q.length;u+=1)q[u].c();I=k(),y=i("div"),Q=i("label"),Q.innerHTML=ae,W=k(),M=i("input"),$=k(),x=i("div"),S=i("label"),S.innerHTML=de,ee=k(),U=i("input"),te=k(),d=i("div"),T=i("label"),m=i("input"),se=k(),X=i("span"),X.textContent=be,V=k(),P=i("label"),p=i("input"),ne=k(),K=i("span"),K.textContent=fe,re=k(),z=i("button"),O&&O.c(),ve=ie(`
                        Generate Code`),xe=k(),B&&B.c(),this.h()},l(u){a=c(u,"H1",{class:!0,"data-svelte-h":!0}),J(a)!=="svelte-1y02dnt"&&(a.textContent=e),r=C(u),o=c(u,"DIV",{class:!0});var R=g(o);n=c(R,"DIV",{class:!0});var b=g(n);f=c(b,"DIV",{class:!0});var he=g(f);_=c(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(_)!=="svelte-hc6hcq"&&(_.innerHTML=v),H=C(he),w=c(he,"INPUT",{id:!0,type:!0,class:!0}),he.forEach(h),G=C(b),N=c(b,"LABEL",{class:!0});var ge=g(N);L=c(ge,"DIV",{class:!0,"data-svelte-h":!0}),J(L)!=="svelte-r2mmg"&&(L.innerHTML=F),Z=C(ge),D=c(ge,"SELECT",{class:!0});var Pe=g(D);E=c(Pe,"OPTION",{"data-svelte-h":!0}),J(E)!=="svelte-8xjvh6"&&(E.textContent=j);for(let ye=0;ye<q.length;ye+=1)q[ye].l(Pe);Pe.forEach(h),ge.forEach(h),I=C(b),y=c(b,"DIV",{class:!0});var we=g(y);Q=c(we,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(Q)!=="svelte-rowqhe"&&(Q.innerHTML=ae),W=C(we),M=c(we,"INPUT",{id:!0,type:!0,class:!0}),we.forEach(h),$=C(b),x=c(b,"DIV",{class:!0});var me=g(x);S=c(me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(S)!=="svelte-3i1zdy"&&(S.innerHTML=de),ee=C(me),U=c(me,"INPUT",{id:!0,type:!0,class:!0}),te=C(me),d=c(me,"DIV",{class:!0});var ke=g(d);T=c(ke,"LABEL",{class:!0});var Ce=g(T);m=c(Ce,"INPUT",{type:!0,name:!0,class:!0}),se=C(Ce),X=c(Ce,"SPAN",{class:!0,"data-svelte-h":!0}),J(X)!=="svelte-1t6vrnv"&&(X.textContent=be),Ce.forEach(h),V=C(ke),P=c(ke,"LABEL",{class:!0});var De=g(P);p=c(De,"INPUT",{type:!0,name:!0,class:!0}),ne=C(De),K=c(De,"SPAN",{class:!0,"data-svelte-h":!0}),J(K)!=="svelte-1mh0gi1"&&(K.textContent=fe),De.forEach(h),ke.forEach(h),me.forEach(h),re=C(b),z=c(b,"BUTTON",{class:!0});var Ne=g(z);O&&O.l(Ne),ve=ce(Ne,`
                        Generate Code`),Ne.forEach(h),xe=C(b),B&&B.l(b),b.forEach(h),R.forEach(h),this.h()},h(){l(a,"class","text-3xl font-bold text-white mb-4"),l(_,"class","label"),l(_,"for","storeName"),l(w,"id","storeName"),l(w,"type","text"),l(w,"class","input input-bordered border-black !text-white"),w.disabled=!0,l(f,"class","form-control mb-4"),l(L,"class","label"),E.disabled=!0,E.selected=!0,E.__value="Pick one",Y(E,E.__value),l(D,"class","select select-bordered !text-white"),s[3]===void 0&&Xe(()=>s[20].call(D)),l(N,"class","form-control w-full max-w-xs"),l(Q,"class","label"),l(Q,"for","promotionStartDate"),l(M,"id","promotionStartDate"),l(M,"type","date"),l(M,"class","input input-bordered border-black text-white"),l(y,"class","form-control mb-4"),l(S,"class","label"),l(S,"for","promotionDuration"),l(U,"id","promotionDuration"),l(U,"type","number"),l(U,"class","input input-bordered border-black text-white"),l(m,"type","radio"),l(m,"name","durationUnit"),m.__value="days",Y(m,m.__value),m.checked=A=s[9]==="days",l(m,"class","form-radio text-white"),l(X,"class","ml-2 text-white"),l(T,"class","inline-flex items-center"),l(p,"type","radio"),l(p,"name","durationUnit"),p.__value="hours",Y(p,p.__value),p.checked=ue=s[9]==="hours",l(p,"class","form-radio text-white"),l(K,"class","ml-2 text-white"),l(P,"class","inline-flex items-center"),l(d,"class","mt-2"),l(x,"class","form-control mb-4"),l(z,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full shadow-md"),z.disabled=s[12],l(n,"class","w-full max-w-sm shadow-lg rounded-lg p-6 bg-black"),l(o,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% rounded-lg p-2 max-w-md min-w-[350px]"),Le.p(m,p)},m(u,R){le(u,a,R),le(u,r,R),le(u,o,R),t(o,n),t(n,f),t(f,_),t(f,H),t(f,w),Y(w,s[1]),t(n,G),t(n,N),t(N,L),t(N,Z),t(N,D),t(D,E);for(let b=0;b<q.length;b+=1)q[b]&&q[b].m(D,null);Ae(D,s[3],!0),t(n,I),t(n,y),t(y,Q),t(y,W),t(y,M),Y(M,s[7]),t(n,$),t(n,x),t(x,S),t(x,ee),t(x,U),Y(U,s[8]),t(x,te),t(x,d),t(d,T),t(T,m),m.checked=m.__value===s[9],t(T,se),t(T,X),t(d,V),t(d,P),t(P,p),p.checked=p.__value===s[9],t(P,ne),t(P,K),t(n,re),t(n,z),O&&O.m(z,null),t(z,ve),t(n,xe),B&&B.m(n,null),Ie||(Se=[oe(w,"input",s[19]),oe(D,"change",s[20]),oe(M,"input",s[21]),oe(U,"input",s[22]),oe(m,"change",s[23]),oe(p,"change",s[25]),oe(z,"click",s[16])],Ie=!0)},p(u,R){if(R[0]&2&&w.value!==u[1]&&Y(w,u[1]),R[0]&16){pe=Ve(u[4]);let b;for(b=0;b<pe.length;b+=1){const he=Oe(u,pe,b);q[b]?q[b].p(he,R):(q[b]=je(he),q[b].c(),q[b].m(D,null))}for(;b<q.length;b+=1)q[b].d(1);q.length=pe.length}R[0]&24&&Ae(D,u[3]),R[0]&128&&Y(M,u[7]),R[0]&256&&Je(U.value)!==u[8]&&Y(U,u[8]),R[0]&512&&A!==(A=u[9]==="days")&&(m.checked=A),R[0]&512&&(m.checked=m.__value===u[9]),R[0]&512&&ue!==(ue=u[9]==="hours")&&(p.checked=ue),R[0]&512&&(p.checked=p.__value===u[9]),u[12]?O||(O=ze(),O.c(),O.m(z,ve)):O&&(O.d(1),O=null),R[0]&4096&&(z.disabled=u[12]),u[13]?B?B.p(u,R):(B=Ge(u),B.c(),B.m(n,null)):B&&(B.d(1),B=null)},d(u){u&&(h(a),h(r),h(o)),lt(q,u),O&&O.d(),B&&B.d(),Le.r(),Ie=!1,Ye(Se)}}}function ft(s){let a;return{c(){a=i("span"),this.h()},l(e){a=c(e,"SPAN",{class:!0}),g(a).forEach(h),this.h()},h(){l(a,"class","loading loading-infinity loading-lg text-white")},m(e,r){le(e,a,r)},p:Re,d(e){e&&h(a)}}}function je(s){let a,e=s[29].name+"",r,o;return{c(){a=i("option"),r=ie(e),this.h()},l(n){a=c(n,"OPTION",{});var f=g(a);r=ce(f,e),f.forEach(h),this.h()},h(){a.__value=o=s[29].ref,Y(a,a.__value)},m(n,f){le(n,a,f),t(a,r)},p(n,f){f[0]&16&&e!==(e=n[29].name+"")&&_e(r,e),f[0]&16&&o!==(o=n[29].ref)&&(a.__value=o,Y(a,a.__value))},d(n){n&&h(a)}}}function ze(s){let a;return{c(){a=i("span"),this.h()},l(e){a=c(e,"SPAN",{class:!0}),g(a).forEach(h),this.h()},h(){l(a,"class","loading loading-infinity loading-lg")},m(e,r){le(e,a,r)},d(e){e&&h(a)}}}function Ge(s){let a,e,r,o,n,f;return{c(){a=i("div"),e=qe("svg"),r=qe("path"),o=k(),n=i("span"),f=ie(s[13]),this.h()},l(_){a=c(_,"DIV",{role:!0,class:!0});var v=g(a);e=Me(v,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var H=g(e);r=Me(H,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),g(r).forEach(h),H.forEach(h),o=C(v),n=c(v,"SPAN",{});var w=g(n);f=ce(w,s[13]),w.forEach(h),v.forEach(h),this.h()},h(){l(r,"stroke-linecap","round"),l(r,"stroke-linejoin","round"),l(r,"stroke-width","2"),l(r,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),l(e,"xmlns","http://www.w3.org/2000/svg"),l(e,"class","stroke-current shrink-0 h-6 w-6"),l(e,"fill","none"),l(e,"viewBox","0 0 24 24"),l(a,"role","alert"),l(a,"class","alert bg-gradient-to-r to-[#fd1d1d] from-[#fcb045] !text-white")},m(_,v){le(_,a,v),t(a,e),t(e,r),t(a,o),t(a,n),t(n,f)},p(_,v){v[0]&8192&&_e(f,_[13])},d(_){_&&h(a)}}}function ht(s){let a;function e(n,f){if(n[12])return ft;if(n[6])return ut;if(n[11]&&n[0])return dt}let r=e(s),o=r&&r(s);return{c(){a=i("div"),o&&o.c(),this.h()},l(n){a=c(n,"DIV",{class:!0});var f=g(a);o&&o.l(f),f.forEach(h),this.h()},h(){l(a,"class","p-8 bg-base-100 text-black min-h-screen flex flex-col items-center")},m(n,f){le(n,a,f),o&&o.m(a,null)},p(n,f){r===(r=e(n))&&o?o.p(n,f):(o&&o.d(1),o=r&&r(n),o&&(o.c(),o.m(a,null)))},i:Re,o:Re,d(n){n&&h(a),o&&o.d()}}}const Fe="http://localhost:5173/transaction";function pt(s,a,e){let r,o,n,f;Ee(s,ot,d=>e(18,r=d)),Ee(s,it,d=>e(27,o=d));let _="",v="",H="",w=Qe("");Ee(s,w,d=>e(13,f=d));let G=Qe(!1);Ee(s,G,d=>e(12,n=d));let N,L=[],F,Z=!0,D="",E=0,j="days",I=o.params.codeId,y,Q;We(async()=>{var d;if(I==="new"){const T=st(He(Te,"influencers")),m=await nt(T);e(4,L=m.docs.map(A=>({...A.data(),ref:A.ref})))}else{e(6,Z=!1),y=at(Te,"codes",I);const T=await Be(y);e(11,Q=T.data()),e(2,H=`${Fe}/${I}`),e(0,_=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(H)}&size=200x200&format=png`);const m=Q.influencer,se=(await Be(m)).data();e(5,F=se.name)}e(1,v=(d=r==null?void 0:r.userData)==null?void 0:d.name),console.log("merchantName",v)});const ae=()=>{e(3,N=""),e(7,D=""),e(8,E=0),e(9,j="days"),e(1,v="")},W=async()=>{if(!N||!D.trim()||E<=0){w.set("All fields are required.");return}G.set(!0);try{const d=await rt(He(Te,"codes"),{influencer:N,promotionStartDate:D,promotionDuration:E,durationUnit:j,merchant:r.userRef,usageCount:0,timestamp:new Date});e(10,I=d.id),e(2,H=`${Fe}/${I}`),e(0,_=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(H)}&size=200x200&format=png`),w.set(""),await ct(`/campaigns/${I}`),window.location.reload()}catch(d){console.error("Error generating QR Code:",d),w.set("Error generating QR code. Please try again.")}G.set(!1),ae()},M=()=>{fetch(_).then(d=>d.blob()).then(d=>{const T=window.URL.createObjectURL(d),m=document.createElement("a");m.style.display="none",m.href=T,m.download="qrcode.png",document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(T)}).catch(d=>{console.error("Error downloading the QR code:",d),w.set("Error downloading the QR code. Please try again.")})},$=[[]];function x(){v=this.value,e(1,v),e(18,r)}function S(){N=et(this),e(3,N),e(4,L)}function de(){D=this.value,e(7,D)}function ee(){E=Je(this.value),e(8,E)}function U(){j=this.__value,e(9,j)}function te(){j=this.__value,e(9,j)}return s.$$.update=()=>{var d;s.$$.dirty[0]&262144&&r&&e(1,v=(d=r==null?void 0:r.userData)==null?void 0:d.name)},[_,v,H,N,L,F,Z,D,E,j,I,Q,n,f,w,G,W,M,r,x,S,de,ee,U,$,te]}class Dt extends Ze{constructor(a){super(),$e(this,a,pt,ht,Ke,{},null,[-1,-1])}}export{Dt as component};
