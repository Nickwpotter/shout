import{s as oe,n as Y,c as q,o as ie,r as ce}from"../chunks/scheduler.PCYk-eKx.js";import{S as ue,i as de,e as p,c as h,a as w,d as f,p as r,g as M,w as ne,s as N,k as se,q as Q,f as A,A as J,t as P,B as K,b as j,h as c,j as X,y as W,r as ee}from"../chunks/index.BWac97FB.js";import{a as fe,d as ae,b as re,e as me,c as pe,u as he,i as be}from"../chunks/firebase.C7CWxqOX.js";import{w as te}from"../chunks/index.eg0ioKiZ.js";import{p as ve}from"../chunks/stores.B8qUxFip.js";import{a as _e}from"../chunks/authStore.Dc8xNwkm.js";function we(i){let e,t="Register Transaction",s,n;function o(a,m){return a[6]?De:xe}let u=o(i),l=u(i);return{c(){e=p("h1"),e.textContent=t,s=N(),l.c(),n=se(),this.h()},l(a){e=h(a,"H1",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-uix1vj"&&(e.textContent=t),s=A(a),l.l(a),n=se(),this.h()},h(){r(e,"class","text-3xl font-bold text-black mb-6")},m(a,m){M(a,e,m),M(a,s,m),l.m(a,m),M(a,n,m)},p(a,m){u===(u=o(a))&&l?l.p(a,m):(l.d(1),l=u(a),l&&(l.c(),l.m(n.parentNode,n)))},d(a){a&&(f(e),f(s),f(n)),l.d(a)}}}function ge(i){let e,t='<div class="card rounded-lg w-96 bg-base-100 shadow-xl"><figure class="px-10 pt-10"><img src="https://plus.unsplash.com/premium_photo-1681487956679-59fb4ffef9b8?q=80&amp;w=1760&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Shoes" class="rounded-xl"/></figure> <div class="card-body items-center text-center"><h2 class="card-title text-white">Transaction Successful!</h2> <p class="text-white">Thanks for working with Shout</p></div></div>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-9rkt22"&&(e.innerHTML=t),this.h()},h(){r(e,"class","card rounded-lg w-98 p-2 bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90%")},m(s,n){M(s,e,n)},p:Y,d(s){s&&f(e)}}}function ke(i){let e;return{c(){e=p("span"),this.h()},l(t){e=h(t,"SPAN",{class:!0}),w(e).forEach(f),this.h()},h(){r(e,"class","loading loading-infinity loading-lg text-white")},m(t,s){M(t,e,s)},p:Y,d(t){t&&f(e)}}}function xe(i){let e,t,s,n,o,u;return{c(){e=p("div"),t=J("svg"),s=J("path"),n=N(),o=p("span"),u=P(i[7]),this.h()},l(l){e=h(l,"DIV",{role:!0,class:!0});var a=w(e);t=K(a,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var m=w(t);s=K(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(s).forEach(f),m.forEach(f),n=A(a),o=h(a,"SPAN",{});var x=w(o);u=j(x,i[7]),x.forEach(f),a.forEach(f),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","stroke-current shrink-0 h-6 w-6"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(e,"role","alert"),r(e,"class","alert bg-gradient-to-r to-[#fd1d1d] from-[#fcb045] !text-white")},m(l,a){M(l,e,a),c(e,t),c(t,s),c(e,n),c(e,o),c(o,u)},p(l,a){a&128&&X(u,l[7])},d(l){l&&f(e)}}}function De(i){let e,t,s,n,o,u,l,a,m,x,k,D,T='<span class="text-white">Employee Name</span>',V,b,H,g,I,z='<span class="text-white">Transaction Amount</span>',R,d,S,E,U="Submit Transaction",L,B,G,v=i[7]&&le(i);return{c(){e=p("div"),t=p("div"),s=p("p"),n=P("Influencer Email: "),o=P(i[3]),u=N(),l=p("p"),a=P("QR Code ID: "),m=P(i[4]),x=N(),k=p("div"),D=p("label"),D.innerHTML=T,V=N(),b=p("input"),H=N(),g=p("div"),I=p("label"),I.innerHTML=z,R=N(),d=p("input"),S=N(),E=p("button"),E.textContent=U,L=N(),v&&v.c(),this.h()},l(_){e=h(_,"DIV",{class:!0});var C=w(e);t=h(C,"DIV",{class:!0});var y=w(t);s=h(y,"P",{class:!0});var Z=w(s);n=j(Z,"Influencer Email: "),o=j(Z,i[3]),Z.forEach(f),u=A(y),l=h(y,"P",{class:!0});var $=w(l);a=j($,"QR Code ID: "),m=j($,i[4]),$.forEach(f),x=A(y),k=h(y,"DIV",{class:!0});var F=w(k);D=h(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Q(D)!=="svelte-1avw4ly"&&(D.innerHTML=T),V=A(F),b=h(F,"INPUT",{id:!0,type:!0,class:!0}),F.forEach(f),H=A(y),g=h(y,"DIV",{class:!0});var O=w(g);I=h(O,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Q(I)!=="svelte-12ukgw8"&&(I.innerHTML=z),R=A(O),d=h(O,"INPUT",{id:!0,type:!0,class:!0}),O.forEach(f),S=A(y),E=h(y,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(E)!=="svelte-11wxde2"&&(E.textContent=U),L=A(y),v&&v.l(y),y.forEach(f),C.forEach(f),this.h()},h(){r(s,"class","text-white font-bold mb-2"),r(l,"class","text-white font-bold mb-2"),r(D,"class","label"),r(D,"for","employeeName"),r(b,"id","employeeName"),r(b,"type","text"),r(b,"class","input input-bordered border-black text-white"),r(k,"class","form-control mb-4"),r(I,"class","label"),r(I,"for","transactionAmount"),r(d,"id","transactionAmount"),r(d,"type","number"),r(d,"class","input input-bordered border-black text-white"),r(g,"class","form-control mb-4"),r(E,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full shadow-md"),r(t,"class","w-full max-w-md shadow-lg rounded-lg p-6 bg-black"),r(e,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full min-w-[350px] max-w-md p-2")},m(_,C){M(_,e,C),c(e,t),c(t,s),c(s,n),c(s,o),c(t,u),c(t,l),c(l,a),c(l,m),c(t,x),c(t,k),c(k,D),c(k,V),c(k,b),W(b,i[1]),c(t,H),c(t,g),c(g,I),c(g,R),c(g,d),W(d,i[2]),c(t,S),c(t,E),c(t,L),v&&v.m(t,null),B||(G=[ee(b,"input",i[12]),ee(d,"input",i[13]),ee(E,"click",i[11])],B=!0)},p(_,C){C&8&&X(o,_[3]),C&16&&X(m,_[4]),C&2&&b.value!==_[1]&&W(b,_[1]),C&4&&ne(d.value)!==_[2]&&W(d,_[2]),_[7]?v?v.p(_,C):(v=le(_),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},d(_){_&&f(e),v&&v.d(),B=!1,ce(G)}}}function le(i){let e,t,s,n,o,u;return{c(){e=p("div"),t=J("svg"),s=J("path"),n=N(),o=p("span"),u=P(i[7]),this.h()},l(l){e=h(l,"DIV",{role:!0,class:!0});var a=w(e);t=K(a,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var m=w(t);s=K(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(s).forEach(f),m.forEach(f),n=A(a),o=h(a,"SPAN",{});var x=w(o);u=j(x,i[7]),x.forEach(f),a.forEach(f),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","stroke-current shrink-0 h-6 w-6"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(e,"role","alert"),r(e,"class","alert bg-gradient-to-r to-[#fd1d1d] from-[#fcb045] !text-white")},m(l,a){M(l,e,a),c(e,t),c(t,s),c(e,n),c(e,o),c(o,u)},p(l,a){a&128&&X(u,l[7])},d(l){l&&f(e)}}}function ye(i){let e;function t(o,u){return o[0]?ke:o[5]?ge:we}let s=t(i),n=s(i);return{c(){e=p("div"),n.c(),this.h()},l(o){e=h(o,"DIV",{class:!0});var u=w(e);n.l(u),u.forEach(f),this.h()},h(){r(e,"class","p-8 bg-base-100 text-black min-h-screen flex flex-col items-center")},m(o,u){M(o,e,u),n.m(e,null)},p(o,[u]){s===(s=t(o))&&n?n.p(o,u):(n.d(1),n=s(o),n&&(n.c(),n.m(e,null)))},i:Y,o:Y,d(o){o&&f(e),n.d()}}}function Ee(i,e,t){let s,n,o,u,l;q(i,_e,d=>t(16,n=d)),q(i,ve,d=>t(17,o=d));let a="",m="",x="",k="",D=te(!1);q(i,D,d=>t(6,u=d));let T=te("");q(i,T,d=>t(7,l=d));let V,b,H=!1,g=te(!0);q(i,g,d=>t(0,s=d)),ie(async()=>{if(t(4,k=o.params.codeId),g.set,k){V=fe(ae,"codes",k);const d=await re(V);if(d.exists()){b=d.data();const S=new Date().getTime(),E=b.timestamp.toDate().getTime(),U=Number(b.promotionDuration),L=b.durationUnit;let B=!1;if(L==="days"?B=(S-E)/(1e3*60*60*24)<=U:L==="hours"&&(B=(S-E)/(1e3*60*60)<=U),B){const G=b.influencer,_=(await re(G)).data();t(3,x=_.email),D.set(!0)}else T.set("This code is no longer valid.")}else T.set("Invalid QR code.")}else T.set("No code found.");g.set(!1)});const I=async()=>{const d=parseFloat(m);if(!a.trim()||d<=0||isNaN(d)){T.set("All fields are required and the transaction amount must be a valid number.");return}g.set(!0);try{await me(pe(ae,"transactions"),{codeId:k,code:V,influencer:b.influencer,employeeName:a,transactionAmount:d,merchant:n.userRef,timestamp:new Date}),await he(V,{usageCount:be(1)}),t(5,H=!0)}catch(S){console.error("Error submitting transaction:",S),T.set("Error submitting transaction. Please try again.")}finally{g.set(!1)}};function z(){a=this.value,t(1,a)}function R(){m=ne(this.value),t(2,m)}return i.$$.update=()=>{i.$$.dirty&1&&console.log("loading",s)},[s,a,m,x,k,H,u,l,D,T,g,I,z,R]}class Ve extends ue{constructor(e){super(),de(this,e,Ee,ye,oe,{})}}export{Ve as component};
