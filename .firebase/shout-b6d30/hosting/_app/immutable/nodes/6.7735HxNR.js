import{s as Ke,n as xe,c as Ee,o as We,d as Ae,e as Xe,r as Ye}from"../chunks/scheduler.PCYk-eKx.js";import{S as Ze,i as $e,e as r,c as i,a as g,d as f,p as a,g as Z,v as et,w as Je,q as G,s as k,t as ie,f as C,b as ce,h as l,r as re,j as _e,x as tt,y as Y,z as Ue,u as lt,A as qe,B as Me}from"../chunks/index.BWac97FB.js";import{e as Ve}from"../chunks/each.D6YF6ztN.js";import{a as at,d as Re,b as Be,q as nt,c as He,g as st,e as ot}from"../chunks/firebase.C7CWxqOX.js";import{w as Qe}from"../chunks/index.eg0ioKiZ.js";import{a as rt}from"../chunks/authStore.Dc8xNwkm.js";import{p as it}from"../chunks/stores.B8qUxFip.js";import{g as ct}from"../chunks/entry.D5liSSLQ.js";function Oe(n,t,e){const s=n.slice();return s[29]=t[e],s}function dt(n){let t,e="Something went wrong";return{c(){t=r("div"),t.textContent=e},l(s){t=i(s,"DIV",{"data-svelte-h":!0}),G(t)!=="svelte-1xwo6cz"&&(t.textContent=e)},m(s,c){Z(s,t,c)},p:xe,d(s){s&&f(t)}}}function ut(n){let t,e,s,c,o,h,_,v,H="Merchant:",w,F,N,L,J,$="Influencer:",D,E,j,I,y,Q="Start Date:",ae,W=n[11].promotionStartDate+"",M,ee,x,S,de="QR Code ID:",te,A,le,d,T,p,U,ne="Download QR Code",X,be;return{c(){t=r("div"),e=r("div"),s=r("div"),c=r("img"),h=k(),_=r("p"),v=r("span"),v.textContent=H,w=k(),F=ie(n[1]),N=k(),L=r("p"),J=r("span"),J.textContent=$,D=k(),E=ie(n[5]),j=k(),I=r("p"),y=r("span"),y.textContent=Q,ae=k(),M=ie(W),ee=k(),x=r("p"),S=r("span"),S.textContent=de,te=k(),A=ie(n[10]),le=k(),d=r("a"),T=ie("Test QR Code Link"),p=k(),U=r("button"),U.textContent=ne,this.h()},l(V){t=i(V,"DIV",{class:!0});var P=g(t);e=i(P,"DIV",{class:!0});var m=g(e);s=i(m,"DIV",{class:!0});var ue=g(s);c=i(ue,"IMG",{src:!0,alt:!0,class:!0}),ue.forEach(f),h=C(m),_=i(m,"P",{class:!0});var se=g(_);v=i(se,"SPAN",{class:!0,"data-svelte-h":!0}),G(v)!=="svelte-5erjst"&&(v.textContent=H),w=C(se),F=ce(se,n[1]),se.forEach(f),N=C(m),L=i(m,"P",{class:!0});var K=g(L);J=i(K,"SPAN",{class:!0,"data-svelte-h":!0}),G(J)!=="svelte-8hwr1a"&&(J.textContent=$),D=C(K),E=ce(K,n[5]),K.forEach(f),j=C(m),I=i(m,"P",{class:!0});var fe=g(I);y=i(fe,"SPAN",{class:!0,"data-svelte-h":!0}),G(y)!=="svelte-92ix5p"&&(y.textContent=Q),ae=C(fe),M=ce(fe,W),fe.forEach(f),ee=C(m),x=i(m,"P",{class:!0});var oe=g(x);S=i(oe,"SPAN",{class:!0,"data-svelte-h":!0}),G(S)!=="svelte-2oankk"&&(S.textContent=de),te=C(oe),A=ce(oe,n[10]),oe.forEach(f),le=C(m),d=i(m,"A",{href:!0,target:!0,class:!0});var z=g(d);T=ce(z,"Test QR Code Link"),z.forEach(f),p=C(m),U=i(m,"BUTTON",{class:!0,"data-svelte-h":!0}),G(U)!=="svelte-i8nhyw"&&(U.textContent=ne),m.forEach(f),P.forEach(f),this.h()},h(){Ae(c.src,o=n[0])||a(c,"src",o),a(c,"alt","QR Code"),a(c,"class","w-40 h-40"),a(s,"class","bg-white p-2 mb-4 rounded-lg"),a(v,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(_,"class","text-white font-bold mb-2"),a(J,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(L,"class","text-white font-bold mb-2"),a(y,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(I,"class","text-white font-bold mb-2"),a(S,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(x,"class","text-white font-bold mb-2"),a(d,"href",n[2]),a(d,"target","_blank"),a(d,"class","btn btn-active btn-link"),a(U,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full mt-4"),a(e,"class","w-full max-w-sm shadow-lg rounded-lg p-6 bg-black flex flex-col items-center"),a(t,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% p-2 rounded-lg")},m(V,P){Z(V,t,P),l(t,e),l(e,s),l(s,c),l(e,h),l(e,_),l(_,v),l(_,w),l(_,F),l(e,N),l(e,L),l(L,J),l(L,D),l(L,E),l(e,j),l(e,I),l(I,y),l(I,ae),l(I,M),l(e,ee),l(e,x),l(x,S),l(x,te),l(x,A),l(e,le),l(e,d),l(d,T),l(e,p),l(e,U),X||(be=re(U,"click",n[17]),X=!0)},p(V,P){P[0]&1&&!Ae(c.src,o=V[0])&&a(c,"src",o),P[0]&2&&_e(F,V[1]),P[0]&32&&_e(E,V[5]),P[0]&2048&&W!==(W=V[11].promotionStartDate+"")&&_e(M,W),P[0]&1024&&_e(A,V[10]),P[0]&4&&a(d,"href",V[2])},d(V){V&&f(t),X=!1,be()}}}function ft(n){let t,e="Create Campaign Code",s,c,o,h,_,v='<span class="text-white">Merchant</span>',H,w,F,N,L,J='<span class="!text-white">Influencer</span>',$,D,E,j="Pick one",I,y,Q,ae='<span class="text-white">Promotion Start Date</span>',W,M,ee,x,S,de='<span class="text-white">Promotion Duration</span>',te,A,le,d,T,p,U,ne,X,be="Days",V,P,m,ue,se,K,fe="Hours",oe,z,ve,Le,Ie,Pe,Se,pe=Ve(n[4]),q=[];for(let u=0;u<pe.length;u+=1)q[u]=je(Oe(n,pe,u));let O=n[12]&&ze(),B=n[13]&&Ge(n);return Ie=tt(n[24][0]),{c(){t=r("h1"),t.textContent=e,s=k(),c=r("div"),o=r("div"),h=r("div"),_=r("label"),_.innerHTML=v,H=k(),w=r("input"),F=k(),N=r("label"),L=r("div"),L.innerHTML=J,$=k(),D=r("select"),E=r("option"),E.textContent=j;for(let u=0;u<q.length;u+=1)q[u].c();I=k(),y=r("div"),Q=r("label"),Q.innerHTML=ae,W=k(),M=r("input"),ee=k(),x=r("div"),S=r("label"),S.innerHTML=de,te=k(),A=r("input"),le=k(),d=r("div"),T=r("label"),p=r("input"),ne=k(),X=r("span"),X.textContent=be,V=k(),P=r("label"),m=r("input"),se=k(),K=r("span"),K.textContent=fe,oe=k(),z=r("button"),O&&O.c(),ve=ie(`
                        Generate Code`),Le=k(),B&&B.c(),this.h()},l(u){t=i(u,"H1",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1y02dnt"&&(t.textContent=e),s=C(u),c=i(u,"DIV",{class:!0});var R=g(c);o=i(R,"DIV",{class:!0});var b=g(o);h=i(b,"DIV",{class:!0});var he=g(h);_=i(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),G(_)!=="svelte-hc6hcq"&&(_.innerHTML=v),H=C(he),w=i(he,"INPUT",{id:!0,type:!0,class:!0}),he.forEach(f),F=C(b),N=i(b,"LABEL",{class:!0});var ge=g(N);L=i(ge,"DIV",{class:!0,"data-svelte-h":!0}),G(L)!=="svelte-r2mmg"&&(L.innerHTML=J),$=C(ge),D=i(ge,"SELECT",{class:!0});var Ne=g(D);E=i(Ne,"OPTION",{"data-svelte-h":!0}),G(E)!=="svelte-8xjvh6"&&(E.textContent=j);for(let Te=0;Te<q.length;Te+=1)q[Te].l(Ne);Ne.forEach(f),ge.forEach(f),I=C(b),y=i(b,"DIV",{class:!0});var we=g(y);Q=i(we,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),G(Q)!=="svelte-rowqhe"&&(Q.innerHTML=ae),W=C(we),M=i(we,"INPUT",{id:!0,type:!0,class:!0}),we.forEach(f),ee=C(b),x=i(b,"DIV",{class:!0});var me=g(x);S=i(me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),G(S)!=="svelte-3i1zdy"&&(S.innerHTML=de),te=C(me),A=i(me,"INPUT",{id:!0,type:!0,class:!0}),le=C(me),d=i(me,"DIV",{class:!0});var ke=g(d);T=i(ke,"LABEL",{class:!0});var Ce=g(T);p=i(Ce,"INPUT",{type:!0,name:!0,class:!0}),ne=C(Ce),X=i(Ce,"SPAN",{class:!0,"data-svelte-h":!0}),G(X)!=="svelte-1t6vrnv"&&(X.textContent=be),Ce.forEach(f),V=C(ke),P=i(ke,"LABEL",{class:!0});var De=g(P);m=i(De,"INPUT",{type:!0,name:!0,class:!0}),se=C(De),K=i(De,"SPAN",{class:!0,"data-svelte-h":!0}),G(K)!=="svelte-1mh0gi1"&&(K.textContent=fe),De.forEach(f),ke.forEach(f),me.forEach(f),oe=C(b),z=i(b,"BUTTON",{class:!0});var ye=g(z);O&&O.l(ye),ve=ce(ye,`
                        Generate Code`),ye.forEach(f),Le=C(b),B&&B.l(b),b.forEach(f),R.forEach(f),this.h()},h(){a(t,"class","text-3xl font-bold text-white mb-4"),a(_,"class","label"),a(_,"for","storeName"),a(w,"id","storeName"),a(w,"type","text"),a(w,"class","input input-bordered border-black !text-white"),w.disabled=!0,a(h,"class","form-control mb-4"),a(L,"class","label"),E.disabled=!0,E.selected=!0,E.__value="Pick one",Y(E,E.__value),a(D,"class","select select-bordered !text-white"),n[3]===void 0&&Xe(()=>n[20].call(D)),a(N,"class","form-control w-full max-w-xs"),a(Q,"class","label"),a(Q,"for","promotionStartDate"),a(M,"id","promotionStartDate"),a(M,"type","date"),a(M,"class","input input-bordered border-black text-white"),a(y,"class","form-control mb-4"),a(S,"class","label"),a(S,"for","promotionDuration"),a(A,"id","promotionDuration"),a(A,"type","number"),a(A,"class","input input-bordered border-black text-white"),a(p,"type","radio"),a(p,"name","durationUnit"),p.__value="days",Y(p,p.__value),p.checked=U=n[9]==="days",a(p,"class","form-radio text-white"),a(X,"class","ml-2 text-white"),a(T,"class","inline-flex items-center"),a(m,"type","radio"),a(m,"name","durationUnit"),m.__value="hours",Y(m,m.__value),m.checked=ue=n[9]==="hours",a(m,"class","form-radio text-white"),a(K,"class","ml-2 text-white"),a(P,"class","inline-flex items-center"),a(d,"class","mt-2"),a(x,"class","form-control mb-4"),a(z,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full shadow-md"),z.disabled=n[12],a(o,"class","w-full max-w-sm shadow-lg rounded-lg p-6 bg-black"),a(c,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% rounded-lg p-2 max-w-md min-w-[350px]"),Ie.p(p,m)},m(u,R){Z(u,t,R),Z(u,s,R),Z(u,c,R),l(c,o),l(o,h),l(h,_),l(h,H),l(h,w),Y(w,n[1]),l(o,F),l(o,N),l(N,L),l(N,$),l(N,D),l(D,E);for(let b=0;b<q.length;b+=1)q[b]&&q[b].m(D,null);Ue(D,n[3],!0),l(o,I),l(o,y),l(y,Q),l(y,W),l(y,M),Y(M,n[7]),l(o,ee),l(o,x),l(x,S),l(x,te),l(x,A),Y(A,n[8]),l(x,le),l(x,d),l(d,T),l(T,p),p.checked=p.__value===n[9],l(T,ne),l(T,X),l(d,V),l(d,P),l(P,m),m.checked=m.__value===n[9],l(P,se),l(P,K),l(o,oe),l(o,z),O&&O.m(z,null),l(z,ve),l(o,Le),B&&B.m(o,null),Pe||(Se=[re(w,"input",n[19]),re(D,"change",n[20]),re(M,"input",n[21]),re(A,"input",n[22]),re(p,"change",n[23]),re(m,"change",n[25]),re(z,"click",n[16])],Pe=!0)},p(u,R){if(R[0]&2&&w.value!==u[1]&&Y(w,u[1]),R[0]&16){pe=Ve(u[4]);let b;for(b=0;b<pe.length;b+=1){const he=Oe(u,pe,b);q[b]?q[b].p(he,R):(q[b]=je(he),q[b].c(),q[b].m(D,null))}for(;b<q.length;b+=1)q[b].d(1);q.length=pe.length}R[0]&24&&Ue(D,u[3]),R[0]&128&&Y(M,u[7]),R[0]&256&&Je(A.value)!==u[8]&&Y(A,u[8]),R[0]&512&&U!==(U=u[9]==="days")&&(p.checked=U),R[0]&512&&(p.checked=p.__value===u[9]),R[0]&512&&ue!==(ue=u[9]==="hours")&&(m.checked=ue),R[0]&512&&(m.checked=m.__value===u[9]),u[12]?O||(O=ze(),O.c(),O.m(z,ve)):O&&(O.d(1),O=null),R[0]&4096&&(z.disabled=u[12]),u[13]?B?B.p(u,R):(B=Ge(u),B.c(),B.m(o,null)):B&&(B.d(1),B=null)},d(u){u&&(f(t),f(s),f(c)),lt(q,u),O&&O.d(),B&&B.d(),Ie.r(),Pe=!1,Ye(Se)}}}function ht(n){let t;return{c(){t=r("span"),this.h()},l(e){t=i(e,"SPAN",{class:!0}),g(t).forEach(f),this.h()},h(){a(t,"class","loading loading-infinity loading-lg text-white")},m(e,s){Z(e,t,s)},p:xe,d(e){e&&f(t)}}}function je(n){let t,e=n[29].name+"",s,c;return{c(){t=r("option"),s=ie(e),this.h()},l(o){t=i(o,"OPTION",{});var h=g(t);s=ce(h,e),h.forEach(f),this.h()},h(){t.__value=c=n[29].ref,Y(t,t.__value)},m(o,h){Z(o,t,h),l(t,s)},p(o,h){h[0]&16&&e!==(e=o[29].name+"")&&_e(s,e),h[0]&16&&c!==(c=o[29].ref)&&(t.__value=c,Y(t,t.__value))},d(o){o&&f(t)}}}function ze(n){let t;return{c(){t=r("span"),this.h()},l(e){t=i(e,"SPAN",{class:!0}),g(t).forEach(f),this.h()},h(){a(t,"class","loading loading-infinity loading-lg")},m(e,s){Z(e,t,s)},d(e){e&&f(t)}}}function Ge(n){let t,e,s,c,o,h;return{c(){t=r("div"),e=qe("svg"),s=qe("path"),c=k(),o=r("span"),h=ie(n[13]),this.h()},l(_){t=i(_,"DIV",{role:!0,class:!0});var v=g(t);e=Me(v,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var H=g(e);s=Me(H,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),g(s).forEach(f),H.forEach(f),c=C(v),o=i(v,"SPAN",{});var w=g(o);h=ce(w,n[13]),w.forEach(f),v.forEach(f),this.h()},h(){a(s,"stroke-linecap","round"),a(s,"stroke-linejoin","round"),a(s,"stroke-width","2"),a(s,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"class","stroke-current shrink-0 h-6 w-6"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(t,"role","alert"),a(t,"class","alert bg-gradient-to-r to-[#fd1d1d] from-[#fcb045] !text-white")},m(_,v){Z(_,t,v),l(t,e),l(e,s),l(t,c),l(t,o),l(o,h)},p(_,v){v[0]&8192&&_e(h,_[13])},d(_){_&&f(t)}}}function pt(n){let t;function e(o,h){return o[12]?ht:o[6]?ft:o[11]&&o[0]?ut:dt}let s=e(n),c=s(n);return{c(){t=r("div"),c.c(),this.h()},l(o){t=i(o,"DIV",{class:!0});var h=g(t);c.l(h),h.forEach(f),this.h()},h(){a(t,"class","p-8 bg-base-100 text-black min-h-screen flex flex-col items-center")},m(o,h){Z(o,t,h),c.m(t,null)},p(o,h){s===(s=e(o))&&c?c.p(o,h):(c.d(1),c=s(o),c&&(c.c(),c.m(t,null)))},i:xe,o:xe,d(o){o&&f(t),c.d()}}}const Fe="http://localhost:5173/app/transaction";function mt(n,t,e){let s,c,o,h;Ee(n,rt,d=>e(18,s=d)),Ee(n,it,d=>e(27,c=d));let _="",v="",H="",w=Qe("");Ee(n,w,d=>e(13,h=d));let F=Qe(!1);Ee(n,F,d=>e(12,o=d));let N,L=[],J,$=!0,D="",E=0,j="days",I=c.params.codeId,y,Q;We(async()=>{var d;if(I==="new"){const T=nt(He(Re,"influencers")),p=await st(T);e(4,L=p.docs.map(U=>({...U.data(),ref:U.ref})))}else{e(6,$=!1),y=at(Re,"codes",I);const T=await Be(y);e(11,Q=T.data()),e(2,H=`${Fe}/${I}`),e(0,_=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(H)}&size=200x200&format=png`);const p=Q.influencer;console.log(p);const ne=(await Be(p)).data();e(5,J=ne.name)}e(1,v=(d=s==null?void 0:s.userData)==null?void 0:d.name),console.log("merchantName",v)});const ae=()=>{e(3,N=""),e(7,D=""),e(8,E=0),e(9,j="days"),e(1,v="")},W=async()=>{if(!N||!D.trim()||E<=0){w.set("All fields are required.");return}F.set(!0);try{const d=await ot(He(Re,"codes"),{influencer:N,promotionStartDate:D,promotionDuration:E,durationUnit:j,merchant:s.userRef,usageCount:0,timestamp:new Date});e(10,I=d.id),e(2,H=`${Fe}/${I}`),e(0,_=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(H)}&size=200x200&format=png`),w.set(""),await ct(`/app/campaigns/${I}`),window.location.reload()}catch(d){console.error("Error generating QR Code:",d),w.set("Error generating QR code. Please try again.")}F.set(!1),ae()},M=()=>{fetch(_).then(d=>d.blob()).then(d=>{const T=window.URL.createObjectURL(d),p=document.createElement("a");p.style.display="none",p.href=T,p.download="qrcode.png",document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(T)}).catch(d=>{console.error("Error downloading the QR code:",d),w.set("Error downloading the QR code. Please try again.")})},ee=[[]];function x(){v=this.value,e(1,v),e(18,s)}function S(){N=et(this),e(3,N),e(4,L)}function de(){D=this.value,e(7,D)}function te(){E=Je(this.value),e(8,E)}function A(){j=this.__value,e(9,j)}function le(){j=this.__value,e(9,j)}return n.$$.update=()=>{var d;n.$$.dirty[0]&262144&&s&&e(1,v=(d=s==null?void 0:s.userData)==null?void 0:d.name)},[_,v,H,N,L,J,$,D,E,j,I,Q,o,h,w,F,W,M,s,x,S,de,te,A,ee,le]}class Et extends Ze{constructor(t){super(),$e(this,t,mt,pt,Ke,{},null,[-1,-1])}}export{Et as component};
