import{s as bt,n as Ae,c as Se,o as gt,d as $e,e as wt,r as Ct}from"../chunks/scheduler.PCYk-eKx.js";import{S as Dt,i as kt,e as r,c as i,a as h,d as c,q as a,g as ue,v as Et,w as mt,p as J,s as b,t as Z,f as g,b as $,h as t,r as Te,j as be,x as Tt,y as ge,z as et,u as _t,A as tt,B as lt}from"../chunks/index.CKmYMgu1.js";import{e as ze}from"../chunks/each.D6YF6ztN.js";import{a as xt,d as je,b as Ye,q as at,w as st,c as Je,g as nt,e as It}from"../chunks/firebase.C7CWxqOX.js";import{w as Ke}from"../chunks/index.eg0ioKiZ.js";import{a as Lt}from"../chunks/authStore.Cjia8BFJ.js";import{p as yt}from"../chunks/stores.CUhjNm-V.js";import{g as ot}from"../chunks/entry.Cpyu-pHp.js";function rt(s,e,l){const n=s.slice();return n[38]=e[l],n[40]=l,n}function it(s,e,l){const n=s.slice();return n[35]=e[l],n}function Pt(s){let e,l="Something went wrong";return{c(){e=r("div"),e.textContent=l},l(n){e=i(n,"DIV",{"data-svelte-h":!0}),J(e)!=="svelte-1xwo6cz"&&(e.textContent=l)},m(n,d){ue(n,e,d)},p:Ae,d(n){n&&c(e)}}}function Vt(s){let e,l,n,d,o="Total Sales",u,C,L,x=s[12].toFixed(2)+"",m,_,f,D,p="Average Transaction Price",F,E,P,K=s[13].toFixed(2)+"",V,w,A,X,re="Total Code Transactions",B,ie,G,ae,se,fe,T,he,Y,ee,U,te,ce,ve="Merchant:",I,pe,q,y,H,me="Influencer:",le,De,ke,O,ne,Pe="Start Date:",Ie,Ee=s[11].promotionStartDate+"",Le,we,N,M,W="QR Code ID:",v,R,k,_e,de,Ve="Download QR Code",xe,Ce,ye,Q=s[0].userType==="merchant"&&ct(s),j=s[17].length>0&&s[0].userType=="merchant"&&dt(s);return{c(){e=r("div"),l=r("div"),n=r("div"),d=r("div"),d.textContent=o,u=b(),C=r("div"),L=Z("$"),m=Z(x),_=b(),f=r("div"),D=r("div"),D.textContent=p,F=b(),E=r("div"),P=Z("$"),V=Z(K),w=b(),A=r("div"),X=r("div"),X.textContent=re,B=b(),ie=r("div"),G=Z(s[14]),ae=b(),se=r("div"),fe=r("div"),T=r("div"),he=r("div"),Y=r("img"),U=b(),te=r("p"),ce=r("span"),ce.textContent=ve,I=b(),pe=Z(s[2]),q=b(),y=r("p"),H=r("span"),H.textContent=me,le=b(),De=Z(s[5]),ke=b(),O=r("p"),ne=r("span"),ne.textContent=Pe,Ie=b(),Le=Z(Ee),we=b(),N=r("p"),M=r("span"),M.textContent=W,v=b(),R=Z(s[10]),k=b(),Q&&Q.c(),_e=b(),de=r("button"),de.textContent=Ve,xe=b(),j&&j.c(),this.h()},l(S){e=i(S,"DIV",{class:!0});var z=h(e);l=i(z,"DIV",{class:!0});var Ne=h(l);n=i(Ne,"DIV",{class:!0});var Re=h(n);d=i(Re,"DIV",{class:!0,"data-svelte-h":!0}),J(d)!=="svelte-1r9t4va"&&(d.textContent=o),u=g(Re),C=i(Re,"DIV",{class:!0});var Fe=h(C);L=$(Fe,"$"),m=$(Fe,x),Fe.forEach(c),Re.forEach(c),_=g(Ne),f=i(Ne,"DIV",{class:!0});var Ue=h(f);D=i(Ue,"DIV",{class:!0,"data-svelte-h":!0}),J(D)!=="svelte-1lkd4am"&&(D.textContent=p),F=g(Ue),E=i(Ue,"DIV",{class:!0});var Ge=h(E);P=$(Ge,"$"),V=$(Ge,K),Ge.forEach(c),Ue.forEach(c),w=g(Ne),A=i(Ne,"DIV",{class:!0});var Me=h(A);X=i(Me,"DIV",{class:!0,"data-svelte-h":!0}),J(X)!=="svelte-19jqvas"&&(X.textContent=re),B=g(Me),ie=i(Me,"DIV",{class:!0});var We=h(ie);G=$(We,s[14]),We.forEach(c),Me.forEach(c),Ne.forEach(c),ae=g(z),se=i(z,"DIV",{class:!0});var qe=h(se);fe=i(qe,"DIV",{class:!0});var Xe=h(fe);T=i(Xe,"DIV",{class:!0});var oe=h(T);he=i(oe,"DIV",{class:!0});var Ze=h(he);Y=i(Ze,"IMG",{src:!0,alt:!0,class:!0}),Ze.forEach(c),U=g(oe),te=i(oe,"P",{class:!0});var Be=h(te);ce=i(Be,"SPAN",{class:!0,"data-svelte-h":!0}),J(ce)!=="svelte-5erjst"&&(ce.textContent=ve),I=g(Be),pe=$(Be,s[2]),Be.forEach(c),q=g(oe),y=i(oe,"P",{class:!0});var He=h(y);H=i(He,"SPAN",{class:!0,"data-svelte-h":!0}),J(H)!=="svelte-8hwr1a"&&(H.textContent=me),le=g(He),De=$(He,s[5]),He.forEach(c),ke=g(oe),O=i(oe,"P",{class:!0});var Oe=h(O);ne=i(Oe,"SPAN",{class:!0,"data-svelte-h":!0}),J(ne)!=="svelte-92ix5p"&&(ne.textContent=Pe),Ie=g(Oe),Le=$(Oe,Ee),Oe.forEach(c),we=g(oe),N=i(oe,"P",{class:!0});var Qe=h(N);M=i(Qe,"SPAN",{class:!0,"data-svelte-h":!0}),J(M)!=="svelte-2oankk"&&(M.textContent=W),v=g(Qe),R=$(Qe,s[10]),Qe.forEach(c),k=g(oe),Q&&Q.l(oe),_e=g(oe),de=i(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(de)!=="svelte-i8nhyw"&&(de.textContent=Ve),oe.forEach(c),Xe.forEach(c),xe=g(qe),j&&j.l(qe),qe.forEach(c),z.forEach(c),this.h()},h(){a(d,"class","stat-title"),a(C,"class","stat-value"),a(n,"class","stat"),a(D,"class","stat-title"),a(E,"class","stat-value"),a(f,"class","stat"),a(X,"class","stat-title"),a(ie,"class","stat-value"),a(A,"class","stat"),a(l,"class","lg:flex-row stats stats-vertical md:stats-horizontal shadow w-full"),$e(Y.src,ee=s[1])||a(Y,"src",ee),a(Y,"alt","QR Code"),a(Y,"class","w-40 h-40"),a(he,"class","bg-white p-2 mb-4 rounded-lg"),a(ce,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(te,"class","text-white font-bold mb-2"),a(H,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(y,"class","text-white font-bold mb-2"),a(ne,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(O,"class","text-white font-bold mb-2"),a(M,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% inline-block text-transparent bg-clip-text"),a(N,"class","text-white font-bold mb-2"),a(de,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full mt-4"),a(T,"class","min-w-sm shadow-lg rounded-lg p-6 bg-black flex flex-col items-center"),a(fe,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% p-2 rounded-lg flex-col"),a(se,"class","lg:flex-row"),a(e,"class","lg:flex lg:flex-col my-3 py-3")},m(S,z){ue(S,e,z),t(e,l),t(l,n),t(n,d),t(n,u),t(n,C),t(C,L),t(C,m),t(l,_),t(l,f),t(f,D),t(f,F),t(f,E),t(E,P),t(E,V),t(l,w),t(l,A),t(A,X),t(A,B),t(A,ie),t(ie,G),t(e,ae),t(e,se),t(se,fe),t(fe,T),t(T,he),t(he,Y),t(T,U),t(T,te),t(te,ce),t(te,I),t(te,pe),t(T,q),t(T,y),t(y,H),t(y,le),t(y,De),t(T,ke),t(T,O),t(O,ne),t(O,Ie),t(O,Le),t(T,we),t(T,N),t(N,M),t(N,v),t(N,R),t(T,k),Q&&Q.m(T,null),t(T,_e),t(T,de),t(se,xe),j&&j.m(se,null),Ce||(ye=Te(de,"click",s[22]),Ce=!0)},p(S,z){z[0]&4096&&x!==(x=S[12].toFixed(2)+"")&&be(m,x),z[0]&8192&&K!==(K=S[13].toFixed(2)+"")&&be(V,K),z[0]&16384&&be(G,S[14]),z[0]&2&&!$e(Y.src,ee=S[1])&&a(Y,"src",ee),z[0]&4&&be(pe,S[2]),z[0]&32&&be(De,S[5]),z[0]&2048&&Ee!==(Ee=S[11].promotionStartDate+"")&&be(Le,Ee),z[0]&1024&&be(R,S[10]),S[0].userType==="merchant"?Q?Q.p(S,z):(Q=ct(S),Q.c(),Q.m(T,_e)):Q&&(Q.d(1),Q=null),S[17].length>0&&S[0].userType=="merchant"?j?j.p(S,z):(j=dt(S),j.c(),j.m(se,null)):j&&(j.d(1),j=null)},d(S){S&&c(e),Q&&Q.d(),j&&j.d(),Ce=!1,ye()}}}function Nt(s){let e,l="Create Campaign Code",n,d,o,u,C,L='<span class="text-white">Merchant</span>',x,m,_,f,D,p='<span class="!text-white">Influencer</span>',F,E,P,K="Pick one",V,w,A,X='<span class="text-white">Promotion Start Date</span>',re,B,ie,G,ae,se='<span class="text-white">Promotion Duration</span>',fe,T,he,Y,ee,U,te,ce,ve,I="Days",pe,q,y,H,me,le,De="Hours",ke,O,ne,Pe,Ie,Ee,Le,we=ze(s[4]),N=[];for(let v=0;v<we.length;v+=1)N[v]=ft(it(s,we,v));let M=s[15]&&ht(),W=s[16]&&vt(s);return Ie=Tt(s[29][0]),{c(){e=r("h1"),e.textContent=l,n=b(),d=r("div"),o=r("div"),u=r("div"),C=r("label"),C.innerHTML=L,x=b(),m=r("input"),_=b(),f=r("label"),D=r("div"),D.innerHTML=p,F=b(),E=r("select"),P=r("option"),P.textContent=K;for(let v=0;v<N.length;v+=1)N[v].c();V=b(),w=r("div"),A=r("label"),A.innerHTML=X,re=b(),B=r("input"),ie=b(),G=r("div"),ae=r("label"),ae.innerHTML=se,fe=b(),T=r("input"),he=b(),Y=r("div"),ee=r("label"),U=r("input"),ce=b(),ve=r("span"),ve.textContent=I,pe=b(),q=r("label"),y=r("input"),me=b(),le=r("span"),le.textContent=De,ke=b(),O=r("button"),M&&M.c(),ne=Z(`
                        Generate Code`),Pe=b(),W&&W.c(),this.h()},l(v){e=i(v,"H1",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1y02dnt"&&(e.textContent=l),n=g(v),d=i(v,"DIV",{class:!0});var R=h(d);o=i(R,"DIV",{class:!0});var k=h(o);u=i(k,"DIV",{class:!0});var _e=h(u);C=i(_e,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(C)!=="svelte-hc6hcq"&&(C.innerHTML=L),x=g(_e),m=i(_e,"INPUT",{id:!0,type:!0,class:!0}),_e.forEach(c),_=g(k),f=i(k,"LABEL",{class:!0});var de=h(f);D=i(de,"DIV",{class:!0,"data-svelte-h":!0}),J(D)!=="svelte-r2mmg"&&(D.innerHTML=p),F=g(de),E=i(de,"SELECT",{class:!0});var Ve=h(E);P=i(Ve,"OPTION",{"data-svelte-h":!0}),J(P)!=="svelte-8xjvh6"&&(P.textContent=K);for(let z=0;z<N.length;z+=1)N[z].l(Ve);Ve.forEach(c),de.forEach(c),V=g(k),w=i(k,"DIV",{class:!0});var xe=h(w);A=i(xe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(A)!=="svelte-rowqhe"&&(A.innerHTML=X),re=g(xe),B=i(xe,"INPUT",{id:!0,type:!0,class:!0}),xe.forEach(c),ie=g(k),G=i(k,"DIV",{class:!0});var Ce=h(G);ae=i(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(ae)!=="svelte-3i1zdy"&&(ae.innerHTML=se),fe=g(Ce),T=i(Ce,"INPUT",{id:!0,type:!0,class:!0}),he=g(Ce),Y=i(Ce,"DIV",{class:!0});var ye=h(Y);ee=i(ye,"LABEL",{class:!0});var Q=h(ee);U=i(Q,"INPUT",{type:!0,name:!0,class:!0}),ce=g(Q),ve=i(Q,"SPAN",{class:!0,"data-svelte-h":!0}),J(ve)!=="svelte-1t6vrnv"&&(ve.textContent=I),Q.forEach(c),pe=g(ye),q=i(ye,"LABEL",{class:!0});var j=h(q);y=i(j,"INPUT",{type:!0,name:!0,class:!0}),me=g(j),le=i(j,"SPAN",{class:!0,"data-svelte-h":!0}),J(le)!=="svelte-1mh0gi1"&&(le.textContent=De),j.forEach(c),ye.forEach(c),Ce.forEach(c),ke=g(k),O=i(k,"BUTTON",{class:!0});var S=h(O);M&&M.l(S),ne=$(S,`
                        Generate Code`),S.forEach(c),Pe=g(k),W&&W.l(k),k.forEach(c),R.forEach(c),this.h()},h(){a(e,"class","text-3xl font-bold text-white mb-4"),a(C,"class","label"),a(C,"for","storeName"),a(m,"id","storeName"),a(m,"type","text"),a(m,"class","input input-bordered border-black !text-white"),m.disabled=!0,a(u,"class","form-control mb-4"),a(D,"class","label"),P.disabled=!0,P.selected=!0,P.__value="Pick one",ge(P,P.__value),a(E,"class","select select-bordered !text-white"),s[3]===void 0&&wt(()=>s[25].call(E)),a(f,"class","form-control w-full max-w-xs"),a(A,"class","label"),a(A,"for","promotionStartDate"),a(B,"id","promotionStartDate"),a(B,"type","date"),a(B,"class","input input-bordered border-black text-white"),a(w,"class","form-control mb-4"),a(ae,"class","label"),a(ae,"for","promotionDuration"),a(T,"id","promotionDuration"),a(T,"type","number"),a(T,"class","input input-bordered border-black text-white"),a(U,"type","radio"),a(U,"name","durationUnit"),U.__value="days",ge(U,U.__value),U.checked=te=s[9]==="days",a(U,"class","form-radio text-white"),a(ve,"class","ml-2 text-white"),a(ee,"class","inline-flex items-center"),a(y,"type","radio"),a(y,"name","durationUnit"),y.__value="hours",ge(y,y.__value),y.checked=H=s[9]==="hours",a(y,"class","form-radio text-white"),a(le,"class","ml-2 text-white"),a(q,"class","inline-flex items-center"),a(Y,"class","mt-2"),a(G,"class","form-control mb-4"),a(O,"class","btn bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% !text-white !rounded-lg border-none w-full shadow-md"),O.disabled=s[15],a(o,"class","w-full max-w-sm shadow-lg rounded-lg p-6 bg-black"),a(d,"class","bg-gradient-to-r from-[#833ab4] from-10% via-[#fd1d1d] via-30% to-[#fcb045] to-90% rounded-lg p-2 max-w-md min-w-[350px]"),Ie.p(U,y)},m(v,R){ue(v,e,R),ue(v,n,R),ue(v,d,R),t(d,o),t(o,u),t(u,C),t(u,x),t(u,m),ge(m,s[2]),t(o,_),t(o,f),t(f,D),t(f,F),t(f,E),t(E,P);for(let k=0;k<N.length;k+=1)N[k]&&N[k].m(E,null);et(E,s[3],!0),t(o,V),t(o,w),t(w,A),t(w,re),t(w,B),ge(B,s[7]),t(o,ie),t(o,G),t(G,ae),t(G,fe),t(G,T),ge(T,s[8]),t(G,he),t(G,Y),t(Y,ee),t(ee,U),U.checked=U.__value===s[9],t(ee,ce),t(ee,ve),t(Y,pe),t(Y,q),t(q,y),y.checked=y.__value===s[9],t(q,me),t(q,le),t(o,ke),t(o,O),M&&M.m(O,null),t(O,ne),t(o,Pe),W&&W.m(o,null),Ee||(Le=[Te(m,"input",s[24]),Te(E,"change",s[25]),Te(B,"input",s[26]),Te(T,"input",s[27]),Te(U,"change",s[28]),Te(y,"change",s[30]),Te(O,"click",s[21])],Ee=!0)},p(v,R){if(R[0]&4&&m.value!==v[2]&&ge(m,v[2]),R[0]&16){we=ze(v[4]);let k;for(k=0;k<we.length;k+=1){const _e=it(v,we,k);N[k]?N[k].p(_e,R):(N[k]=ft(_e),N[k].c(),N[k].m(E,null))}for(;k<N.length;k+=1)N[k].d(1);N.length=we.length}R[0]&24&&et(E,v[3]),R[0]&128&&ge(B,v[7]),R[0]&256&&mt(T.value)!==v[8]&&ge(T,v[8]),R[0]&512&&te!==(te=v[9]==="days")&&(U.checked=te),R[0]&512&&(U.checked=U.__value===v[9]),R[0]&512&&H!==(H=v[9]==="hours")&&(y.checked=H),R[0]&512&&(y.checked=y.__value===v[9]),v[15]?M||(M=ht(),M.c(),M.m(O,ne)):M&&(M.d(1),M=null),R[0]&32768&&(O.disabled=v[15]),v[16]?W?W.p(v,R):(W=vt(v),W.c(),W.m(o,null)):W&&(W.d(1),W=null)},d(v){v&&(c(e),c(n),c(d)),_t(N,v),M&&M.d(),W&&W.d(),Ie.r(),Ee=!1,Ct(Le)}}}function St(s){let e;return{c(){e=r("span"),this.h()},l(l){e=i(l,"SPAN",{class:!0}),h(e).forEach(c),this.h()},h(){a(e,"class","loading loading-infinity loading-lg text-white")},m(l,n){ue(l,e,n)},p:Ae,d(l){l&&c(e)}}}function ct(s){let e,l="Test QR Code Link",n,d;return{c(){e=r("button"),e.textContent=l,this.h()},l(o){e=i(o,"BUTTON",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-ry5jaa"&&(e.textContent=l),this.h()},h(){a(e,"class","btn !text-white btn-active btn-link")},m(o,u){ue(o,e,u),n||(d=Te(e,"click",s[23]),n=!0)},p:Ae,d(o){o&&c(e),n=!1,d()}}}function dt(s){let e,l,n="Recent Transactions",d,o,u,C='<tr><th class="hidden md:table-cell">Row #</th> <th>Employee Name</th> <th class="hidden sm:table-cell">Date</th> <th>Transaction Value</th></tr>',L,x,m=ze(s[17]),_=[];for(let f=0;f<m.length;f+=1)_[f]=ut(rt(s,m,f));return{c(){e=r("div"),l=r("h1"),l.textContent=n,d=b(),o=r("table"),u=r("thead"),u.innerHTML=C,L=b(),x=r("tbody");for(let f=0;f<_.length;f+=1)_[f].c();this.h()},l(f){e=i(f,"DIV",{class:!0});var D=h(e);l=i(D,"H1",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-1353wcu"&&(l.textContent=n),d=g(D),o=i(D,"TABLE",{class:!0});var p=h(o);u=i(p,"THEAD",{"data-svelte-h":!0}),J(u)!=="svelte-1s0pp4l"&&(u.innerHTML=C),L=g(p),x=i(p,"TBODY",{});var F=h(x);for(let E=0;E<_.length;E+=1)_[E].l(F);F.forEach(c),p.forEach(c),D.forEach(c),this.h()},h(){a(l,"class","text-white"),a(o,"class","table text-white min-w-full lg:w-auto lg:max-"),a(e,"class","overflow-x-auto flex-col mt-4 lg:mt-0 lg:ml-6")},m(f,D){ue(f,e,D),t(e,l),t(e,d),t(e,o),t(o,u),t(o,L),t(o,x);for(let p=0;p<_.length;p+=1)_[p]&&_[p].m(x,null)},p(f,D){if(D[0]&131072){m=ze(f[17]);let p;for(p=0;p<m.length;p+=1){const F=rt(f,m,p);_[p]?_[p].p(F,D):(_[p]=ut(F),_[p].c(),_[p].m(x,null))}for(;p<_.length;p+=1)_[p].d(1);_.length=m.length}},d(f){f&&c(e),_t(_,f)}}}function ut(s){let e,l,n=s[40]+1+"",d,o,u,C=s[38].employeeName+"",L,x,m,_=new Date(s[38].timestamp.seconds*1e3).toLocaleString()+"",f,D,p,F,E=s[38].transactionAmount.toFixed(2)+"",P,K;return{c(){e=r("tr"),l=r("td"),d=Z(n),o=b(),u=r("td"),L=Z(C),x=b(),m=r("td"),f=Z(_),D=b(),p=r("td"),F=Z("$"),P=Z(E),K=b(),this.h()},l(V){e=i(V,"TR",{});var w=h(e);l=i(w,"TD",{class:!0});var A=h(l);d=$(A,n),A.forEach(c),o=g(w),u=i(w,"TD",{});var X=h(u);L=$(X,C),X.forEach(c),x=g(w),m=i(w,"TD",{class:!0});var re=h(m);f=$(re,_),re.forEach(c),D=g(w),p=i(w,"TD",{});var B=h(p);F=$(B,"$"),P=$(B,E),B.forEach(c),K=g(w),w.forEach(c),this.h()},h(){a(l,"class","hidden md:table-cell"),a(m,"class","hidden sm:table-cell")},m(V,w){ue(V,e,w),t(e,l),t(l,d),t(e,o),t(e,u),t(u,L),t(e,x),t(e,m),t(m,f),t(e,D),t(e,p),t(p,F),t(p,P),t(e,K)},p(V,w){w[0]&131072&&C!==(C=V[38].employeeName+"")&&be(L,C),w[0]&131072&&_!==(_=new Date(V[38].timestamp.seconds*1e3).toLocaleString()+"")&&be(f,_),w[0]&131072&&E!==(E=V[38].transactionAmount.toFixed(2)+"")&&be(P,E)},d(V){V&&c(e)}}}function ft(s){let e,l=s[35].name+"",n,d;return{c(){e=r("option"),n=Z(l),this.h()},l(o){e=i(o,"OPTION",{});var u=h(e);n=$(u,l),u.forEach(c),this.h()},h(){e.__value=d=s[35].ref,ge(e,e.__value)},m(o,u){ue(o,e,u),t(e,n)},p(o,u){u[0]&16&&l!==(l=o[35].name+"")&&be(n,l),u[0]&16&&d!==(d=o[35].ref)&&(e.__value=d,ge(e,e.__value))},d(o){o&&c(e)}}}function ht(s){let e;return{c(){e=r("span"),this.h()},l(l){e=i(l,"SPAN",{class:!0}),h(e).forEach(c),this.h()},h(){a(e,"class","loading loading-infinity loading-lg")},m(l,n){ue(l,e,n)},d(l){l&&c(e)}}}function vt(s){let e,l,n,d,o,u;return{c(){e=r("div"),l=tt("svg"),n=tt("path"),d=b(),o=r("span"),u=Z(s[16]),this.h()},l(C){e=i(C,"DIV",{role:!0,class:!0});var L=h(e);l=lt(L,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var x=h(l);n=lt(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),h(n).forEach(c),x.forEach(c),d=g(L),o=i(L,"SPAN",{});var m=h(o);u=$(m,s[16]),m.forEach(c),L.forEach(c),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"stroke-width","2"),a(n,"d","M10.29 3.86l1.42-1.42 9.42 9.42-1.42 1.42-9.42-9.42zm2.71 6.42V6.7a9 9 0 00-1.71-5.3l1.42-1.42A10.978 10.978 0 0114 6.7v3.58l5.7 5.7a10.978 10.978 0 011.42-1.42L14 6.7v3.58z"),a(l,"xmlns","http://www.w3.org/2000/svg"),a(l,"class","stroke-current shrink-0 h-6 w-6"),a(l,"fill","none"),a(l,"viewBox","0 0 24 24"),a(e,"role","alert"),a(e,"class","alert bg-gradient-to-r to-[#fd1d1d] from-[#fcb045] !text-white")},m(C,L){ue(C,e,L),t(e,l),t(l,n),t(e,d),t(e,o),t(o,u)},p(C,L){L[0]&65536&&be(u,C[16])},d(C){C&&c(e)}}}function At(s){let e;function l(o,u){return o[15]?St:o[6]?Nt:o[11]&&o[1]?Vt:Pt}let n=l(s),d=n(s);return{c(){e=r("div"),d.c(),this.h()},l(o){e=i(o,"DIV",{class:!0});var u=h(e);d.l(u),u.forEach(c),this.h()},h(){a(e,"class","p-8 bg-base-100 text-black min-h-screen flex flex-col items-center")},m(o,u){ue(o,e,u),d.m(e,null)},p(o,u){n===(n=l(o))&&d?d.p(o,u):(d.d(1),d=n(o),d&&(d.c(),d.m(e,null)))},i:Ae,o:Ae,d(o){o&&c(e),d.d()}}}const pt="https://shout-b6d30.web.app/transaction";function Rt(s,e,l){let n,d,o,u,C;Se(s,Lt,I=>l(0,n=I)),Se(s,yt,I=>l(33,d=I));let L="",x="",m="",_=Ke("");Se(s,_,I=>l(16,u=I));let f=Ke(!1);Se(s,f,I=>l(15,o=I));let D,p=[],F,E=!0,P="",K=0,V="days",w=d.params.codeId,A,X,re=Ke([]);Se(s,re,I=>l(17,C=I));let B=0,ie=0,G=0;gt(async()=>{var y;if(w==="new"){const H=at(Je(je,"users"),st("type","==","influencer")),me=await nt(H);l(4,p=me.docs.map(le=>({...le.data(),ref:le.ref})))}else{l(6,E=!1),A=xt(je,"codes",w);const H=await Ye(A);l(11,X=H.data()),m=`${pt}/${w}`,l(1,L=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(m)}&size=200x200&format=png`);const me=X.influencer,De=(await Ye(me)).data();l(5,F=De.name);const ke=X.merchant,ne=(await Ye(ke)).data();l(2,x=ne.name)}n.userType==="merchant"&&l(2,x=(y=n==null?void 0:n.userData)==null?void 0:y.name);const I=at(Je(je,"transactions"),st("code","==",A));let q=(await nt(I)).docs.map(H=>({...H.data(),id:H.id}));re.set(q),l(14,G=q.length),l(12,B=q.reduce((H,me)=>H+me.transactionAmount,0)),l(13,ie=G>0?B/G:0)});const ae=()=>{l(3,D=""),l(7,P=""),l(8,K=0),l(9,V="days"),l(2,x="")},se=async()=>{if(!D||!P.trim()||K<=0){_.set("All fields are required.");return}f.set(!0);try{const I=await It(Je(je,"codes"),{influencer:D,promotionStartDate:P,promotionDuration:K,durationUnit:V,merchant:n.userRef,usageCount:0,timestamp:new Date});l(10,w=I.id),m=`${pt}/${w}`,l(1,L=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(m)}&size=200x200&format=png`),_.set(""),await ot(`/app/campaigns/${w}`),window.location.reload()}catch(I){console.error("Error generating QR Code:",I),_.set("Error generating QR code. Please try again.")}f.set(!1),ae()},fe=()=>{fetch(L).then(I=>I.blob()).then(I=>{const pe=window.URL.createObjectURL(I),q=document.createElement("a");q.style.display="none",q.href=pe,q.download="qrcode.png",document.body.appendChild(q),q.click(),window.URL.revokeObjectURL(pe)}).catch(I=>{console.error("Error downloading the QR code:",I),_.set("Error downloading the QR code. Please try again.")})},T=()=>{ot(`/app/transaction/${w}`)},he=[[]];function Y(){x=this.value,l(2,x),l(0,n)}function ee(){D=Et(this),l(3,D),l(4,p)}function U(){P=this.value,l(7,P)}function te(){K=mt(this.value),l(8,K)}function ce(){V=this.__value,l(9,V)}function ve(){V=this.__value,l(9,V)}return s.$$.update=()=>{var I;s.$$.dirty[0]&1&&n&&l(2,x=(I=n==null?void 0:n.userData)==null?void 0:I.name)},[n,L,x,D,p,F,E,P,K,V,w,X,B,ie,G,o,u,C,_,f,re,se,fe,T,Y,ee,U,te,ce,he,ve]}class zt extends Dt{constructor(e){super(),kt(this,e,Rt,At,bt,{},null,[-1,-1])}}export{zt as component};
